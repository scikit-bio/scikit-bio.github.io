<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Distance matrices and distance-based statistics (skbio.stats.distance) &mdash; scikit-bio 0.2.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="scikit-bio 0.2.1 documentation" href="../index.html" />
    <link rel="up" title="Statistics (skbio.stats)" href="../stats.html" />
    <link rel="next" title="skbio.stats.distance.DissimilarityMatrix" href="generated/skbio.stats.distance.DissimilarityMatrix.html" />
    <link rel="prev" title="skbio.stats.subsample" href="skbio.stats.subsample.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
  
  <a href="https://github.com/biocore/scikit-bio"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          scikit-bio docs</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../alignment.html">Sequence collections and alignments (<tt class="docutils literal"><span class="pre">skbio.alignment</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sequence.html">Biological sequences (<tt class="docutils literal"><span class="pre">skbio.sequence</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tree.html">Tree representations (<tt class="docutils literal"><span class="pre">skbio.tree</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Constructing workflows (<tt class="docutils literal"><span class="pre">skbio.workflow</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../draw.html">Visualizations (<tt class="docutils literal"><span class="pre">skbio.draw</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../format.sequences.html">Format biological sequences (<tt class="docutils literal"><span class="pre">skbio.format.sequences</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diversity.html">Diversity calculations (<tt class="docutils literal"><span class="pre">skbio.diversity</span></tt>)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../stats.html">Statistics (<tt class="docutils literal"><span class="pre">skbio.stats</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parse.sequences.html">Parse biological sequences (<tt class="docutils literal"><span class="pre">skbio.parse.sequences</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">File I/O (<tt class="docutils literal"><span class="pre">skbio.io</span></tt>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">Utility functionality (<tt class="docutils literal"><span class="pre">skbio.util</span></tt>)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/py3.html">Supporting Python 2 and Python 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/coding_guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/new_module.html">Adding a new module to skbio</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Distance matrices and distance-based statistics (<tt class="docutils literal"><span class="pre">skbio.stats.distance</span></tt>)</a><ul>
<li><a class="reference internal" href="#data-structures-dissimilaritymatrix-and-distancematrix">Data Structures: DissimilarityMatrix and DistanceMatrix</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#distance-based-statistics">Distance-based statistics</a><ul>
<li><a class="reference internal" href="#categorical-variable-stats">Categorical Variable Stats</a></li>
<li><a class="reference internal" href="#continuous-variable-stats">Continuous Variable Stats</a></li>
<li><a class="reference internal" href="#distance-matrix-comparisons">Distance Matrix Comparisons</a></li>
<li><a class="reference internal" href="#id2">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <span class="target" id="module-skbio.stats.distance"></span><div class="section" id="distance-matrices-and-distance-based-statistics-skbio-stats-distance">
<h1>Distance matrices and distance-based statistics (<a class="reference internal" href="#module-skbio.stats.distance" title="skbio.stats.distance"><tt class="xref py py-mod docutils literal"><span class="pre">skbio.stats.distance</span></tt></a>)<a class="headerlink" href="#distance-matrices-and-distance-based-statistics-skbio-stats-distance" title="Permalink to this headline">¶</a></h1>
<p>This subpackage provides functionality for serializing, deserializing, and
manipulating dissimilarity and distance matrices in memory. It also contains
various statistical methods that operate on distance matrices, often relating
distances (e.g., community distances) to categorical and/or continuous
variables of interest (e.g., gender or age). Methods are also provided for
comparing distance matrices (e.g., computing the correlation between two or
more distance matrices using the Mantel test).</p>
<div class="section" id="data-structures-dissimilaritymatrix-and-distancematrix">
<h2>Data Structures: DissimilarityMatrix and DistanceMatrix<a class="headerlink" href="#data-structures-dissimilaritymatrix-and-distancematrix" title="Permalink to this headline">¶</a></h2>
<p>This package provides two matrix classes, <cite>DissimilarityMatrix</cite> and
<cite>DistanceMatrix</cite>. Both classes can store measures of difference/distinction
between objects. A dissimilarity/distance matrix includes both a matrix of
dissimilarities/distances (floats) between objects, as well as unique IDs
(object labels; strings) identifying each object in the matrix.</p>
<p><cite>DissimilarityMatrix</cite> can be used to store measures of dissimilarity between
objects, and does not require that the dissimilarities are symmetric (e.g.,
dissimilarities obtained using the <em>Gain in PD</em> measure <a class="reference internal" href="#r172" id="id1">[R172]</a>).
<cite>DissimilarityMatrix</cite> is a more general container to store differences than
<cite>DistanceMatrix</cite>.</p>
<p><cite>DistanceMatrix</cite> has the additional requirement that the differences it
stores are symmetric (e.g., Euclidean or Hamming distances).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>DissimilarityMatrix</cite> can be used to store distances, but it is
recommended to use <cite>DistanceMatrix</cite> to store this type of data as it
provides an additional check for symmetry. A distance matrix <em>is a</em>
dissimilarity matrix; this is modeled in the class design by having
<cite>DistanceMatrix</cite> subclass <cite>DissimilarityMatrix</cite>.</p>
</div>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.DissimilarityMatrix.html#skbio.stats.distance.DissimilarityMatrix" title="skbio.stats.distance.DissimilarityMatrix"><tt class="xref py py-obj docutils literal"><span class="pre">DissimilarityMatrix</span></tt></a>(data[,&nbsp;ids])</td>
<td>Store dissimilarities between objects.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/skbio.stats.distance.DistanceMatrix.html#skbio.stats.distance.DistanceMatrix" title="skbio.stats.distance.DistanceMatrix"><tt class="xref py py-obj docutils literal"><span class="pre">DistanceMatrix</span></tt></a>(data[,&nbsp;ids])</td>
<td>Store distances between objects.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.randdm.html#skbio.stats.distance.randdm" title="skbio.stats.distance.randdm"><tt class="xref py py-obj docutils literal"><span class="pre">randdm</span></tt></a>(num_objects[,&nbsp;ids,&nbsp;constructor,&nbsp;...])</td>
<td>Generate a distance matrix populated with random distances.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="exceptions">
<h3>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.DissimilarityMatrixError.html#skbio.stats.distance.DissimilarityMatrixError" title="skbio.stats.distance.DissimilarityMatrixError"><tt class="xref py py-obj docutils literal"><span class="pre">DissimilarityMatrixError</span></tt></a></td>
<td>General error for dissimilarity matrix validation failures.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/skbio.stats.distance.DistanceMatrixError.html#skbio.stats.distance.DistanceMatrixError" title="skbio.stats.distance.DistanceMatrixError"><tt class="xref py py-obj docutils literal"><span class="pre">DistanceMatrixError</span></tt></a></td>
<td>General error for distance matrix validation failures.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.MissingIDError.html#skbio.stats.distance.MissingIDError" title="skbio.stats.distance.MissingIDError"><tt class="xref py py-obj docutils literal"><span class="pre">MissingIDError</span></tt></a>(missing_id)</td>
<td>Error for ID lookup that doesn&#8217;t exist in the dissimilarity matrix.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>Assume we have the following delimited text file storing distances between
three objects with IDs <tt class="docutils literal"><span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt>, and <tt class="docutils literal"><span class="pre">c</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>\ta\tb\tc
a\t0.0\t0.5\t1.0
b\t0.5\t0.0\t0.75
c\t1.0\t0.75\t0.0
</pre></div>
</div>
<p>Load a distance matrix from the file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">StringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skbio</span> <span class="kn">import</span> <span class="n">DistanceMatrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm_fh</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">a</span><span class="se">\t</span><span class="s">b</span><span class="se">\t</span><span class="s">c</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="gp">... </span>                 <span class="s">&quot;a</span><span class="se">\t</span><span class="s">0.0</span><span class="se">\t</span><span class="s">0.5</span><span class="se">\t</span><span class="s">1.0</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="gp">... </span>                 <span class="s">&quot;b</span><span class="se">\t</span><span class="s">0.5</span><span class="se">\t</span><span class="s">0.0</span><span class="se">\t</span><span class="s">0.75</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="gp">... </span>                 <span class="s">&quot;c</span><span class="se">\t</span><span class="s">1.0</span><span class="se">\t</span><span class="s">0.75</span><span class="se">\t</span><span class="s">0.0</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">DistanceMatrix</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">dm_fh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>
<span class="go">3x3 distance matrix</span>
<span class="go">IDs:</span>
<span class="go">a, b, c</span>
<span class="go">Data:</span>
<span class="go">[[ 0.    0.5   1.  ]</span>
<span class="go"> [ 0.5   0.    0.75]</span>
<span class="go"> [ 1.    0.75  0.  ]]</span>
</pre></div>
</div>
<p>Access the distance (scalar) between objects <tt class="docutils literal"><span class="pre">'a'</span></tt> and <tt class="docutils literal"><span class="pre">'c'</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">]</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>Get a row vector of distances between object <tt class="docutils literal"><span class="pre">'b'</span></tt> and all other objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
<span class="go">array([ 0.5 ,  0.  ,  0.75])</span>
</pre></div>
</div>
<p>numpy indexing/slicing also works as expected. Extract the third column:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">array([ 1.  ,  0.75,  0.  ])</span>
</pre></div>
</div>
<p>Serialize the distance matrix to delimited text file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">out_fh</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out_fh</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_fh</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span> <span class="o">==</span> <span class="n">dm_fh</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A distance matrix object can also be created from an existing <tt class="docutils literal"><span class="pre">numpy.array</span></tt>
(or an array-like object, such as a nested Python list):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm_from_np</span> <span class="o">=</span> <span class="n">DistanceMatrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dm_from_np</span><span class="p">)</span>
<span class="go">3x3 distance matrix</span>
<span class="go">IDs:</span>
<span class="go">a, b, c</span>
<span class="go">Data:</span>
<span class="go">[[ 0.    0.5   1.  ]</span>
<span class="go"> [ 0.5   0.    0.75]</span>
<span class="go"> [ 1.    0.75  0.  ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm_from_np</span> <span class="o">==</span> <span class="n">dm</span>
<span class="go">True</span>
</pre></div>
</div>
<p>IDs may be omitted when constructing a dissimilarity/distance matrix.
Monotonically-increasing integers (cast as strings) will be automatically used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">DistanceMatrix</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="o">.</span><span class="n">ids</span>
<span class="go">(&#39;0&#39;, &#39;1&#39;, &#39;2&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="distance-based-statistics">
<h2>Distance-based statistics<a class="headerlink" href="#distance-based-statistics" title="Permalink to this headline">¶</a></h2>
<p>In addition to the data structures described above, this package provides the
following distance-based statistical methods.</p>
<div class="section" id="categorical-variable-stats">
<h3>Categorical Variable Stats<a class="headerlink" href="#categorical-variable-stats" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.ANOSIM.html#skbio.stats.distance.ANOSIM" title="skbio.stats.distance.ANOSIM"><tt class="xref py py-obj docutils literal"><span class="pre">ANOSIM</span></tt></a>(distance_matrix,&nbsp;grouping[,&nbsp;column])</td>
<td>ANOSIM statistical method executor.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/skbio.stats.distance.PERMANOVA.html#skbio.stats.distance.PERMANOVA" title="skbio.stats.distance.PERMANOVA"><tt class="xref py py-obj docutils literal"><span class="pre">PERMANOVA</span></tt></a>(distance_matrix,&nbsp;grouping[,&nbsp;column])</td>
<td>PERMANOVA statistical method executor.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.CategoricalStatsResults.html#skbio.stats.distance.CategoricalStatsResults" title="skbio.stats.distance.CategoricalStatsResults"><tt class="xref py py-obj docutils literal"><span class="pre">CategoricalStatsResults</span></tt></a>(short_method_name,&nbsp;...)</td>
<td>Statistical method results container.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="continuous-variable-stats">
<h3>Continuous Variable Stats<a class="headerlink" href="#continuous-variable-stats" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.bioenv.html#skbio.stats.distance.bioenv" title="skbio.stats.distance.bioenv"><tt class="xref py py-obj docutils literal"><span class="pre">bioenv</span></tt></a>(distance_matrix,&nbsp;data_frame[,&nbsp;columns])</td>
<td>Find subset of variables maximally correlated with distances.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="distance-matrix-comparisons">
<h3>Distance Matrix Comparisons<a class="headerlink" href="#distance-matrix-comparisons" title="Permalink to this headline">¶</a></h3>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/skbio.stats.distance.mantel.html#skbio.stats.distance.mantel" title="skbio.stats.distance.mantel"><tt class="xref py py-obj docutils literal"><span class="pre">mantel</span></tt></a>(x,&nbsp;y[,&nbsp;method,&nbsp;permutations,&nbsp;...])</td>
<td>Compute correlation between distance matrices using the Mantel test.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/skbio.stats.distance.pwmantel.html#skbio.stats.distance.pwmantel" title="skbio.stats.distance.pwmantel"><tt class="xref py py-obj docutils literal"><span class="pre">pwmantel</span></tt></a>(dms[,&nbsp;labels,&nbsp;method,&nbsp;...])</td>
<td>Run Mantel tests for every pair of distance matrices.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Load a 4x4 distance matrix and grouping vector denoting 2 groups of objects.
Note that these statistical methods require symmetric distances:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skbio</span> <span class="kn">import</span> <span class="n">DistanceMatrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span> <span class="o">=</span> <span class="n">DistanceMatrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="s">&#39;s1&#39;</span><span class="p">,</span> <span class="s">&#39;s2&#39;</span><span class="p">,</span> <span class="s">&#39;s3&#39;</span><span class="p">,</span> <span class="s">&#39;s4&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grouping</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Group1&#39;</span><span class="p">,</span> <span class="s">&#39;Group1&#39;</span><span class="p">,</span> <span class="s">&#39;Group2&#39;</span><span class="p">,</span> <span class="s">&#39;Group2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Create an ANOSIM instance and run the method with 99 permutations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># Make output deterministic; not necessary for normal use</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skbio.stats.distance</span> <span class="kn">import</span> <span class="n">ANOSIM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anosim</span> <span class="o">=</span> <span class="n">ANOSIM</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">grouping</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">anosim</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">results</span>
<span class="go">Method name  Sample size  Number of groups  R statistic  p-value  Number of permutations</span>
<span class="go">     ANOSIM            4                 2         0.25     0.67                      99</span>
</pre></div>
</div>
<p>It is possible to rerun a method using an existing instance. Rerun ANOSIM with
999 permutations this time. Note that we obtain the same R statistic as before:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">anosim</span><span class="p">(</span><span class="mi">999</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">results</span>
<span class="go">Method name  Sample size  Number of groups  R statistic  p-value  Number of permutations</span>
<span class="go">     ANOSIM            4                 2         0.25    0.667                     999</span>
</pre></div>
</div>
<p>To suppress calculation of the p-value and only obtain the R statistic, specify
zero permutations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">anosim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">results</span>
<span class="go">Method name  Sample size  Number of groups  R statistic  p-value  Number of permutations</span>
<span class="go">     ANOSIM            4                 2         0.25      N/A                       0</span>
</pre></div>
</div>
<p>A statistical results object can also format its results as delimited text.
This is useful, for example, if you want to view the results in a spreadsheet
program such as Excel:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
<span class="go">Method name,Sample size,Number of groups,R statistic,p-value,Number of permutations</span>
<span class="go">ANOSIM,4,2,0.25,N/A,0</span>
</pre></div>
</div>
<p>Individual values of the results can be accessed via the attributes of the
<tt class="docutils literal"><span class="pre">CategoricalStatsResults</span></tt> class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">statistic</span>
<span class="go">0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">results</span><span class="o">.</span><span class="n">p_value</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">permutations</span>
<span class="go">0</span>
</pre></div>
</div>
<p>You can also provide a <tt class="docutils literal"><span class="pre">pandas.DataFrame</span></tt> and a column denoting the grouping
instead of a grouping vector. The following data frame&#8217;s <tt class="docutils literal"><span class="pre">Group</span></tt> column
specifies the same grouping as the vector we used in all of the previous
examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># Make output deterministic; not necessary for normal use</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s">&#39;Group&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;s2&#39;</span><span class="p">:</span> <span class="s">&#39;Group1&#39;</span><span class="p">,</span> <span class="s">&#39;s3&#39;</span><span class="p">:</span> <span class="s">&#39;Group2&#39;</span><span class="p">,</span> <span class="s">&#39;s4&#39;</span><span class="p">:</span> <span class="s">&#39;Group2&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s">&#39;s5&#39;</span><span class="p">:</span> <span class="s">&#39;Group3&#39;</span><span class="p">,</span> <span class="s">&#39;s1&#39;</span><span class="p">:</span> <span class="s">&#39;Group1&#39;</span><span class="p">}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anosim</span> <span class="o">=</span> <span class="n">ANOSIM</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s">&#39;Group&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">anosim</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">results</span>
<span class="go">Method name  Sample size  Number of groups  R statistic  p-value  Number of permutations</span>
<span class="go">     ANOSIM            4                 2         0.25     0.67                      99</span>
</pre></div>
</div>
<p>The results match the results we saw in the first example above.</p>
<p>Note that when providing a data frame, the ordering of rows and/or columns does
not affect the grouping vector that is extracted. The data frame must be
indexed by the distance matrix IDs (i.e., the row labels must be distance
matrix IDs).</p>
<p>If IDs (rows) are present in the data frame but not in the distance matrix,
they are ignored (the previous example&#8217;s <tt class="docutils literal"><span class="pre">s5</span></tt> ID illustrates this behavior).
Thus, the data frame can be a superset of the distance matrix IDs. Note that
the reverse is not true: IDs in the distance matrix <em>must</em> be present in the
data frame or an error will be raised.</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="r172" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R172]</a></td><td>Faith, D. P. (1992). &#8220;Conservation evaluation and phylogenetic
diversity&#8221;.</td></tr>
</tbody>
</table>
</div>
</div>


    </div>
      
  </div>
</div>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014--, scikit-bio development team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6636235-9', 'scikit-bio.org');
    ga('send', 'pageview');
  </script>

  </body>
</html>